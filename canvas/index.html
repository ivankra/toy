<!DOCTYPE html>
<html>
<head>
  <title>HTML5 Canvas</title>
  <style>
    body {
      margin: 0px;
      touch-action: none;
    }
    #canvas {
      width: 100%;
      height: 100vh;
      display: block;
    }
  </style>
</head>
<body>
  <canvas id="canvas"></canvas>
  <script>
    const canvas = document.querySelector('#canvas');
    const ctx = canvas.getContext('2d');
    let isDrawing, lastX, lastY, totalLen = 0;

    function initCanvas(e) {
      canvas.width = canvas.clientWidth;
      canvas.height = canvas.clientHeight;

      ctx.font = '20px sans-serif';
      ctx.fillText('Draw something using mouse or touch', 20, 20+20);
    }

    function getXY(e) {
      const touch = e.touches ? e.touches[0] : e;
      const rect = canvas.getBoundingClientRect();
      return [
        Math.trunc((touch.clientX - rect.left) / canvas.clientWidth * canvas.width),
        Math.trunc((touch.clientY - rect.top) / canvas.clientHeight * canvas.height),
      ];
    }

    function calcHue(i, a = 210, b = 270) {
      const w = b - a;
      return a + ((i % (2 * w)) >= w ? (w - i % w) : (i % w));
    }

    function drawStart(e) {
      if (isDrawing === undefined) {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
      }
      isDrawing = true;
      [lastX, lastY] = getXY(e);
      e.preventDefault();
    }

    function drawEnd(e) {
      isDrawing = false;
      e.preventDefault();
    }

    function drawMove(e) {
      if (!isDrawing) return;

      const [x, y] = getXY(e);
      ctx.strokeStyle = `hsl(${calcHue(totalLen)} 100% 50%)`;
      ctx.lineWidth = 2;
      ctx.lineCap = 'round';
      ctx.beginPath();
      ctx.moveTo(lastX, lastY);
      ctx.lineTo(x, y);
      ctx.stroke();

      totalLen += Math.abs(x - lastX) + Math.abs(y - lastY);
      [lastX, lastY] = [x, y];
      e.preventDefault();
    }

    window.addEventListener('load', initCanvas);

    canvas.addEventListener('mousedown', drawStart);
    canvas.addEventListener('mouseup', drawEnd);
    canvas.addEventListener('mouseout', drawEnd)
    canvas.addEventListener('mousemove', drawMove);

    canvas.addEventListener('touchstart', drawStart);
    canvas.addEventListener('touchend', drawEnd);
    canvas.addEventListener('touchcancel', drawEnd);
    canvas.addEventListener('touchmove', drawMove);
  </script>
</body>
